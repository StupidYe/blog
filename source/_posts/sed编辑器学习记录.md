---
title: sed编辑器学习记录
date: 2017-11-17 13:47:36
tags: [shell]
toc: true
---

#### Shell：sed 编辑器

##### sed编辑器

​	sed命令的格式如下：

​		**sed** *options* *script* *file* 

​	options选项如下：

<!-- more -->

|    选项     |              描述               |
| :-------: | :---------------------------: |
| -e script | 在处理输入时，将script中指定的命令添加到已有的命令中 |
|  -f file  |  在处理输入时，将file中指定的命令添加到已有的命令中  |
|    -n     |    不产生命令输出，使用print命令来完成输出     |

##### sed命令的语法

​	行地址对于任何命令都是可选的。

​	这些命令的语法格式为：[address]command

​	**记住命令还可以用大括号进行分组以使其作用于同一个地址：** 

```
address {
  command1
  command2
  command3
  ...
}
第一个命令可以和左大括号同一行，但是右大括号必须自己单独处于一行。
```

如果命令之间用一个分号间隔，那么可以将多个sed命令放在同一行：

如： `n;d`

> 在n命令后面放一个空格会导致语法错误，但是在d命令前放置一个空格却是可以的。
>
> 不提倡在同一行放置多个命令。

##### 基本sed命令

- s命令替换

  s命令会用斜线间指定的第二个文本字符串来替换第一个文本字符串。比如：`s/test1/test2/ file` 

  > 紧跟在s命令后的字符就是查找串和替换串之间的分隔符，分隔符默认为正斜杠，但可以改变，无论什么字符，只要紧跟着s命令，就成了新的串分隔符。

  在命令行使用多个编辑命令，**只要加上-e选项**，命令之间用分号隔开，并且在命令末尾和分号之间不能有空格。 

  ​`sed -e 's/test1/test2/; s/test3/test4/' file ` 

  - 更多的替换选项

    - 替换标记

      替换标记会在替换命令字符串之后设置。格式为：`s/pattern/replacement/flags` 

      有四种可用的替换标记：

      - 数字：表明新文本将替换第几处模式匹配的地方

      - g：表明新文本将会替换所有匹配的文本

      - p：表明原先行的内容要打印出来

        p替换标记会打印与替换命令中指定的模式匹配的行，**通常和sed的-n选项一起使用**。

        ```shell
        cat data5.txt
        This is a test line.
        This is a different line.

        sed -n 's/test/trial/p' data5.txt
        This is a trial line.
        ```

        **-n标志禁止sed编辑器输出，但p替换标记会输出改过的行，二者配合最终就会输出被替换命令修改过的行** 

      - W file：将模式空间的内容写到文件file中。

- d命令删除

- 指定行的范围：逗号

  行的范围从文件中一个地址开始，在另一个地址结束。地址范围可以是行号，也可以是正则表达式，或者两者集合。

  范围是闭合的，如果条件无法满足，就会一直操作到文件结尾。

- 读命令：r命令

  sed使用该命令将一个文本文件中的内容加到当前文件的特定位置上。

- 写文件： w命令

  sed使用该命令将当前文件中的一些行写到另一个文件中。

- 追加：a命令

  不管是在命令行中还是在sed脚本中，**a命令总是在反斜杠后面** 。

- 修改：c命令

- 获取下一行： n命令

  sed使用该命令获取输入文件的下一行，并将其读入到模式缓冲区中，任何sed命令都将应用到匹配行紧接着的下一行上。

- 插入命令：i

  比如：1i PERSONNEL FILE #在第一行进行i插入操作

- 转换： y命令

  字符按照一对一的方式从左到右进行转行。

  比如，命令y/abc/ABC将把所有小写的a转换成A，b转行成B，c转换成C。

  > 正则表达式元字符对y命令不起作用。
  >
  > 与替换分隔符一样，斜杠可以被替换成其他的字符。

- 退出： q命令

  该命令将导致sed程序退出，且不再进行其他的处理。

备注：

\s 代表空格

\t 代表制表符